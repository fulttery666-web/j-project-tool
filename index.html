<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>å®¢æˆ¶å»ºæª”å·¥å…·</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
<style>
    /* 1. å…¨åŸŸå­—é«”è¨­å®š */
Â  Â  body { 
        font-family: 'Noto Sans TC', 'Microsoft JhengHei', Arial, sans-serif; 
        margin: 0; 
        padding: 0; 
        background: #fafafa; 
    }
    
    /* å°è¦½åˆ— */
Â  Â  .nav { display: flex; background: #333; color: white; }
Â  Â  .nav button {
Â  Â  Â  Â  flex: 1; padding: 15px; border: none; background: #333; color: white;
Â  Â  Â  Â  font-size: 16px; cursor: pointer;
Â  Â  }
Â  Â  .nav button.active { background: #555; }
.page { display: none; padding: 20px; max-width: 1000px; margin: auto; }
.page.active { display: block; }

Â  Â  h2 { margin-top: 0; color: #333; }
    h3 { border-bottom: 2px solid #ddd; padding-bottom: 5px; margin-top: 30px; }

    /* --- æ¬„ä½å°é½Šå„ªåŒ– --- */
    
    .field-row {
        display: flex;
        align-items: flex-start; 
        margin-bottom: 15px;
        border-left: 5px solid #ccc; 
        padding-left: 10px;
    }
    
    .field-row label { 
        font-weight: bold; 
        margin-right: 15px; 
        padding-top: 10px; 
        width: 100px; /* â­ å›ºå®šæ¨™ç±¤å¯¬åº¦ï¼Œè®“å¾Œæ–¹çš„è¼¸å…¥æ¡†é½Šé ­ */
        flex-shrink: 0; 
        text-align: right;
        color: #555;
    }

    .field-row .input-container {
        flex-grow: 1; 
    }

Â  Â  .field-row input, .field-row textarea {
Â  Â  Â  Â  width: 100%; 
Â  Â  Â  Â  padding: 10px; 
Â  Â  Â  Â  border: 1px solid #ccc; 
Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  box-sizing: border-box; 
Â  Â  Â  Â  resize: vertical; 
Â  Â  }

    /* å°ˆé–€çµ¦å–®ä¸€åŸå§‹è³‡æ–™è¼¸å…¥å€çš„æ¨£å¼ */
    #rawInputContainer, #rawInputContainer_full {
        border-left-color: #f7a000; /* çªé¡¯åŸå§‹è³‡æ–™è¼¸å…¥å€ */
        margin-bottom: 30px;
    }

    /* AI çµæœé¡¯ç¤ºå€ */
Â  Â  .ai-result-section { 
        border-left-color: #007bff; 
        padding-left: 10px;
        margin-bottom: 20px;
    } 
    .ai-result-section textarea { 
        background: #eef; 
        border-color: #007bff; 
        color: #111;
        font-weight: 500;
        min-height: 100px;
        margin-bottom: 15px;
    }

Â  Â  button.action {
Â  Â  Â  Â  padding: 10px 15px; background: #007bff; color: white;
Â  Â  Â  Â  border: none; border-radius: 5px; cursor: pointer; margin-top: 10px;
        margin-bottom: 10px;
        transition: background 0.3s;
Â  Â  }
Â  Â  button.action:hover { background: #005fcc; }

Â  Â  .outputBox { /* è¼¸å‡ºå€ä½¿ç”¨å…±ç”¨ class */
Â  Â  Â  Â  white-space: pre-wrap;
Â  Â  Â  Â  background: #fff8e1; 
Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  border: 1px solid #ffcc80; 
Â  Â  Â  Â  min-height: 100px;
Â  Â  Â  Â  font-size: 15px;
Â  Â  Â  Â  color: #333;
Â  Â  }
</style>
</head>

<body>

<div class="nav">
Â  Â  <button class="active" onclick="switchPage('runPage', this)">é™ªè·‘</button>
Â  Â  <button onclick="switchPage('fullPage', this)">æ”¶å–®ä¸€æ¢é¾</button>
</div>

<div id="runPage" class="page active">
Â  Â  <h2>é™ªè·‘å­¸å“¡å»ºæª”</h2>
    
    Â  Â  <div class="field-row">
Â  Â  Â  Â  <label for="name">åç¨±</label>
        <div class="input-container">
Â  Â  Â  Â      <input id="name" />
        </div>
Â  Â  </div>

Â  Â  <div class="field-row">
Â  Â  Â  Â  <label for="ig">IG é€£çµ</label>
        <div class="input-container">
Â  Â  Â  Â      <input id="ig" />
        </div>
Â  Â  </div>

Â  Â  <div class="field-row" style="margin-bottom: 30px;">
Â  Â  Â  Â  <label for="type">ç¶“ç‡Ÿé¡å‹</label>
        <div class="input-container">
Â  Â  Â  Â      <input id="type" />
        </div>
Â  Â  </div>
Â  Â  

Â  Â  Â  Â  <div class="field-row" id="rawInputContainer" style="flex-direction: column;">
        <div style="display: flex; justify-content: space-between; align-items: flex-end;">
Â  Â  Â  Â      <label style="width: auto; text-align: left;">èƒŒæ™¯è³‡æ–™æ•´ç†ï¼ˆè²¼åŸå§‹æª”æ¡ˆçš„ä¸€å¤§æ®µæ–‡å­—ï¼‰</label>
            <button class="action" onclick="summarize('run')">AI è‡ªå‹•è§£æä¸¦æ•´ç†</button>
        </div>
Â  Â  Â  Â  <textarea id="raw_data_input_run" rows="12"></textarea>
Â  Â  </div>
    
    <hr>
    
Â  Â  <h3 style="margin-bottom: 20px;">âœ… AI æ•´ç†çµæœ</h3>
    
    <div class="ai-result-section">
Â  Â  Â  Â  <label for="reason_ai_run">ğŸ“Œ é™ªè·‘åŸå›  (AI æ•´ç†)</label>
Â  Â  Â  Â  <textarea id="reason_ai_run" rows="4" readonly></textarea>
Â  Â  </div>

    <div class="ai-result-section">
Â  Â  Â  Â  <label for="goal_ai_run">âœ… ç¶“ç‡Ÿç›®æ¨™ (AI æ•´ç†)</label>
Â  Â  Â  Â  <textarea id="goal_ai_run" rows="4" readonly></textarea>
Â  Â  </div>

    <div class="ai-result-section">
Â  Â  Â  Â  <label for="background_ai_run">ğŸ’¡ èƒŒæ™¯è³‡æ–™ (AI æ•´ç†)</label>
Â  Â  Â  Â  <textarea id="background_ai_run" rows="4" readonly></textarea>
Â  Â  </div>
    
    <hr>

Â  Â  <button class="action" onclick="generateOutput('run')">è¼¸å‡ºæ•´åˆå…§å®¹</button>

Â  Â  <h3>è¼¸å‡ºå€ (è«‹è¤‡è£½ä»¥ä¸‹å…§å®¹åˆ° LINE è¨˜äº‹æœ¬)</h3>
Â  Â  <div id="outputBox_run" class="outputBox"></div>
</div>


<div id="fullPage" class="page">
Â  Â  <h2>æ”¶å–®ä¸€æ¢é¾å®¢æˆ¶å»ºæª”</h2>
    
    Â  Â  <div class="field-row">
Â  Â  Â  Â  <label for="name_full">åç¨±</label>
        <div class="input-container">
Â  Â  Â  Â      <input id="name_full" />
        </div>
Â  Â  </div>

Â  Â  <div class="field-row">
Â  Â  Â  Â  <label for="ig_full">IG é€£çµ</label>
        <div class="input-container">
Â  Â  Â  Â      <input id="ig_full" />
        </div>
Â  Â  </div>

Â  Â  <div class="field-row" style="margin-bottom: 30px;">
Â  Â  Â  Â  <label for="type_full">ç¶“ç‡Ÿé¡å‹</label>
        <div class="input-container">
Â  Â  Â  Â      <input id="type_full" />
        </div>
Â  Â  </div>
Â  Â  

Â  Â  Â  Â  <div class="field-row" id="rawInputContainer_full" style="flex-direction: column;">
        <div style="display: flex; justify-content: space-between; align-items: flex-end;">
Â  Â  Â  Â      <label style="width: auto; text-align: left;">æ”¶å–®èƒŒæ™¯è³‡æ–™ï¼ˆè²¼åŸå§‹æª”æ¡ˆçš„ä¸€å¤§æ®µæ–‡å­—ï¼‰</label>
            <button class="action" onclick="summarize('full')">AI è‡ªå‹•è§£æä¸¦æ•´ç†</button>
        </div>
Â  Â  Â  Â  <textarea id="raw_data_input_full" rows="12"></textarea>
Â  Â  </div>
    
    <hr>
    
Â  Â  <h3 style="margin-bottom: 20px;">âœ… AI æ•´ç†çµæœ</h3>
    
    <div class="ai-result-section">
Â  Â  Â  Â  <label for="reason_ai_full">ğŸ“ åƒåŠ åŸå›  (AI æ•´ç†)</label>
Â  Â  Â  Â  <textarea id="reason_ai_full" rows="4" readonly></textarea>
Â  Â  </div>

    <div class="ai-result-section">
Â  Â  Â  Â  <label for="goal_ai_full">ğŸ“ˆ ç¶“ç‡Ÿç›®æ¨™ (AI æ•´ç†)</label>
Â  Â  Â  Â  <textarea id="goal_ai_full" rows="4" readonly></textarea>
Â  Â  </div>

    <div class="ai-result-section">
Â  Â  Â  Â  <label for="background_ai_full">ğŸ’ª èƒŒæ™¯/å„ªå‹¢ (AI æ•´ç†)</label>
Â  Â  Â  Â  <textarea id="background_ai_full" rows="4" readonly></textarea>
Â  Â  </div>
    
    <hr>

Â  Â  <button class="action" onclick="generateOutput('full')">è¼¸å‡ºæ•´åˆå…§å®¹</button>

Â  Â  <h3>è¼¸å‡ºå€ (è«‹è¤‡è£½ä»¥ä¸‹å…§å®¹åˆ° LINE è¨˜äº‹æœ¬)</h3>
Â  Â  <div id="outputBox_full" class="outputBox"></div>
</div>


<script>
// åˆ‡æ›åˆ†é 
function switchPage(pageId, button) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
    button.classList.add('active');
}

// !! â­ æœ€çµ‚ä¿®æ­£ï¼šè«‹å°‡æ‚¨æ–°ç”Ÿæˆçš„ Key è²¼å…¥æ­¤è™•ï¼Œä¸¦ç¢ºä¿å¼•è™Ÿå®Œæ•´ !!
const API_KEY = "AIzaSyCzVGPgU4jI1XONen4PSXV7MqGCNZPmk44"; 
const GEMINI_MODEL = 'gemini-2.5-flash'; 

/**
 * è™•ç† AI æ•´ç†çš„æ ¸å¿ƒå‡½å¼ (æœ€çµ‚ä¿®æ­£ 400 éŒ¯èª¤)
 * @param {string} pageType - é é¢é¡å‹ ('run' for é™ªè·‘, 'full' for æ”¶å–®ä¸€æ¢é¾)
 */
async function summarize(pageType) {
    // ... (å‰ç•¥ï¼Œè®Šæ•¸å®šç¾©éƒ¨åˆ†ä¸è®Š) ...

    const rawTextarea = document.getElementById("raw_data_input" + suffix);
    const text = rawTextarea.value;
    // ... (ä¸­ç•¥ï¼ŒéŒ¯èª¤æª¢æŸ¥éƒ¨åˆ†ä¸è®Š) ...

    try {
        
        // â­ï¸ ä¿®æ­£ï¼šå°‡ JSON æ ¼å¼è¦æ±‚ç¨ç«‹å‡ºä¾†ï¼Œä¸æ”¾åœ¨ systemPrompt ä¸­
        const jsonSchema = {
            type: "object",
            properties: {
                [classificationKeys[0]]: { type: "string", description: `æ•´ç†å¾Œçš„${categoryNames[0]}ï¼ˆæ¢åˆ—å¼ï¼‰` },
                [classificationKeys[1]]: { type: "string", description: `æ•´ç†å¾Œçš„${categoryNames[1]}ï¼ˆæ¢åˆ—å¼ï¼‰` },
                [classificationKeys[2]]: { type: "string", description: `æ•´ç†å¾Œçš„${categoryNames[2]}ï¼ˆæ¢åˆ—å¼ï¼‰` }
            },
            required: classificationKeys,
        };

        const systemPrompt = `ä½ æ˜¯ä¸€ä½è³‡æ·±å®¢æˆ¶é¡§å•ï¼Œè«‹å°‡ä½¿ç”¨è€…è²¼ä¸Šçš„ä¸€å¤§æ®µåŸå§‹è³‡æ–™ï¼Œ**ç²¾æº–è§£æ**ä¸¦**åš´æ ¼**æ•´ç†æˆä»¥ä¸‹ä¸‰å€‹ç¨ç«‹çš„æ¬„ä½ï¼š
        1. ${categoryNames[0]} 
        2. ${categoryNames[1]} 
        3. ${categoryNames[2]} 
        
        è«‹ä½¿ç”¨**æ¸…æ™°çš„æ¢åˆ—å¼**æ‘˜è¦å‘ˆç¾ï¼Œé¿å…åŠ å…¥ä¸»è§€æ¨æ¸¬ã€‚`;
        
        // â­ï¸ ä¿®æ­£ï¼šAPI å‘¼å«çš„ config éƒ¨åˆ†ï¼Œæ”¹ç”¨ responseSchema ç¢ºä¿ JSON è¼¸å‡º
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${API_KEY}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ 
                        role: "user", 
                        parts: [{ text: systemPrompt + "\n\nåŸå§‹å®¢æˆ¶è³‡æ–™ï¼š" + text }]
                    }],
                config: {
                    temperature: 0.0, 
                    // ğŸš¨ ä½¿ç”¨ responseSchema å–ä»£ responseMimeTypeï¼Œæ›´å®‰å…¨
                    responseMimeType: "application/json", 
                    responseSchema: jsonSchema
                }
                })
        });
        
        if (!response.ok) {
            // é€™è£¡æœƒæ•ç² 400 Bad Request
            throw new Error(`API éŒ¯èª¤ï¼š${response.status} ${response.statusText}`);
        }

        const result = await response.json();
        // ... (å¾Œç•¥ï¼Œçµæœè™•ç†éƒ¨åˆ†ä¸è®Š) ...
        
    } catch (error) {
        // ... (å¾Œç•¥ï¼ŒéŒ¯èª¤è¨Šæ¯è™•ç†éƒ¨åˆ†ä¸è®Š) ...
    } finally {
        // ... (å¾Œç•¥) ...
    }
}

/**
 * è¼¸å‡ºæ•´åˆå…§å®¹ (ä¿®æ­£æ ¼å¼å’Œç´”æ›è¡Œ)
 * @param {string} pageType - é é¢é¡å‹ ('run' for é™ªè·‘, 'full' for æ”¶å–®ä¸€æ¢é¾)
 */
function generateOutput(pageType) {
    const suffix = pageType === 'run' ? '_run' : '_full';
    const outputBoxId = "outputBox" + suffix;

    // æŠ“å–å›ºå®šæ¬„ä½
    const name = document.getElementById("name" + (pageType === 'full' ? '_full' : '')).value;
    const ig = document.getElementById("ig" + (pageType === 'full' ? '_full' : '')).value;
    const type = document.getElementById("type" + (pageType === 'full' ? '_full' : '')).value;
    
    // æŠ“å– AI æ•´ç†å¾Œçš„å…§å®¹
    const reason = document.getElementById("reason_ai" + suffix).value; 
    const goal = document.getElementById("goal_ai" + suffix).value;
    const background = document.getElementById("background_ai" + suffix).value;

    let title, reasonLabel, goalLabel, backgroundLabel;
    
    if (pageType === 'run') {
        title = "é™ªè·‘å®¢æˆ¶å»ºæª”";
        reasonLabel = "ğŸ“Œ é™ªè·‘åŸå› ";
        goalLabel = "âœ… å®¢æˆ¶ç›®æ¨™";
        backgroundLabel = "ğŸ’¡ èƒŒæ™¯/å„ªå‹¢";
    } else { // full
        title = "æ”¶å–®ä¸€æ¢é¾å»ºæª”";
        reasonLabel = "ğŸ“ åƒåŠ åŸå› ";
        goalLabel = "ğŸ“ˆ ç¶“ç‡Ÿç›®æ¨™";
        backgroundLabel = "ğŸ’ª èƒŒæ™¯/å„ªå‹¢";
    }

    // â­ï¸ ä¿®æ­£ï¼šç§»é™¤æ‰€æœ‰åˆ†éš”ç·šï¼Œä¿æŒç´”æ›è¡Œ
    const output =
`å®¢æˆ¶æª”æ¡ˆâœï¸ 
[${name || 'ï¼ˆæœªå‘½åï¼‰'}]

ğŸ”— IG é€£çµï¼šhttp://instagram.com/${ig || 'ï¼ˆæœªè¼¸å…¥ï¼‰'}
ğŸ’¼ ç¶“ç‡Ÿé¡å‹ï¼š${type || 'ï¼ˆæœªè¼¸å…¥ï¼‰'}

${reasonLabel}ï¼š
${reason || 'ï¼ˆå°šæœªæ•´ç†ï¼‰'}

${goalLabel}ï¼š
${goal || 'ï¼ˆå°šæœªæ•´ç†ï¼‰'}

${backgroundLabel}ï¼š
${background || 'ï¼ˆå°šæœªæ•´ç†ï¼‰'}
`;

    document.getElementById(outputBoxId).textContent = output;
} 

document.addEventListener('DOMContentLoaded', () => {
    // é€™è£¡åªæ˜¯ç¢ºä¿ ID çš„å¥å£¯æ€§ï¼Œç†è«–ä¸Šåœ¨ HTML ä¸­å·²ç¶“å®šç¾©äº†
});

</script>